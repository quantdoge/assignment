2025-07-14 01:07:27,070 - ModelTrainingRegressor - INFO - Starting XGBoost regressor training process with Dask
2025-07-14 01:07:30,926 - ModelTrainingRegressor - INFO - Dask client created successfully
2025-07-14 01:07:30,927 - ModelTrainingRegressor - INFO - Dashboard link: http://127.0.0.1:8787/status
2025-07-14 01:07:30,929 - ModelTrainingRegressor - INFO - Workers: 5
2025-07-14 01:07:30,929 - ModelTrainingRegressor - INFO - Loading data from silver.train
2025-07-14 01:07:30,929 - ModelTrainingRegressor - INFO - Database path: C:\Users\jason\assignment\assignment.duckdb
2025-07-14 01:07:31,025 - ModelTrainingRegressor - INFO - Successfully loaded 290 rows and 36 columns
2025-07-14 01:07:31,025 - ModelTrainingRegressor - INFO - Data shape: (290, 36)
2025-07-14 01:07:31,124 - ModelTrainingRegressor - INFO - Starting regressor training with Dask...
2025-07-14 01:07:31,124 - ModelTrainingRegressor - INFO - Starting XGBoost regressor training with Dask
2025-07-14 01:07:31,124 - ModelTrainingRegressor - INFO - Response variable: Revenue_CL
2025-07-14 01:07:31,124 - ModelTrainingRegressor - INFO - Predictive variables: ['VolumeCred_CA', 'TransactionsDeb', 'Tenure', 'VolumeDeb_PaymentOrder', 'VolumeCred', 'VolumeDebCash_Card']
2025-07-14 01:07:31,124 - ModelTrainingRegressor - INFO - Categorical variables: []
2025-07-14 01:07:31,124 - ModelTrainingRegressor - INFO - Preparing data...
2025-07-14 01:07:31,129 - ModelTrainingRegressor - INFO - Data after cleaning: (290, 7)
2025-07-14 01:07:31,129 - ModelTrainingRegressor - INFO - Target variable statistics BEFORE scaling: mean=12.0431, std=9.9431, min=1.0714, max=133.2754
2025-07-14 01:07:31,129 - ModelTrainingRegressor - INFO - Applying StandardScaler to response variable...
2025-07-14 01:07:31,131 - ModelTrainingRegressor - INFO - Target variable statistics AFTER scaling: mean=0.0000, std=1.0017, min=-1.1053, max=12.2136
2025-07-14 01:07:31,131 - ModelTrainingRegressor - INFO - Response variable scaling completed successfully
2025-07-14 01:07:31,131 - ModelTrainingRegressor - INFO - Setting up parallel training with Dask...
2025-07-14 01:07:31,139 - ModelTrainingRegressor - INFO - Created 30 parallel training tasks
2025-07-14 01:17:20,209 - ModelTrainingRegressor - INFO - Parallel training completed in 589.07 seconds
2025-07-14 01:17:20,220 - ModelTrainingRegressor - INFO - Training completed. Generated 30 successful results
2025-07-14 01:17:20,220 - ModelTrainingRegressor - INFO - Best MAE score (on scaled target): 5.6683
2025-07-14 01:17:20,221 - ModelTrainingRegressor - INFO - Top 5 results (MAE on scaled target):
2025-07-14 01:17:20,221 - ModelTrainingRegressor - INFO -   Rank 1: MAE=5.6683, K-fold=4, max_depth=13, learning_rate=0.010
2025-07-14 01:17:20,221 - ModelTrainingRegressor - INFO -   Rank 2: MAE=5.6697, K-fold=4, max_depth=5, learning_rate=0.010
2025-07-14 01:17:20,221 - ModelTrainingRegressor - INFO -   Rank 3: MAE=5.6792, K-fold=4, max_depth=10, learning_rate=0.010
2025-07-14 01:17:20,221 - ModelTrainingRegressor - INFO -   Rank 4: MAE=5.6831, K-fold=4, max_depth=10, learning_rate=0.010
2025-07-14 01:17:20,221 - ModelTrainingRegressor - INFO -   Rank 5: MAE=5.6863, K-fold=4, max_depth=11, learning_rate=0.010
2025-07-14 01:17:20,245 - ModelTrainingRegressor - INFO - ✅ Regressor training completed successfully. Generated 30 result combinations
2025-07-14 01:17:20,248 - ModelTrainingRegressor - INFO - Saving model results to models.xgboost_sales_cl_revenue_top
2025-07-14 01:17:20,250 - ModelTrainingRegressor - INFO - Database path: C:\Users\jason\assignment\assignment.duckdb
2025-07-14 01:17:20,273 - ModelTrainingRegressor - INFO - Created/verified schema: models
2025-07-14 01:17:20,273 - ModelTrainingRegressor - INFO - Dropped existing table if present: models.xgboost_sales_cl_revenue_top
2025-07-14 01:17:20,288 - ModelTrainingRegressor - INFO - Successfully created table: models.xgboost_sales_cl_revenue_top
2025-07-14 01:17:20,289 - ModelTrainingRegressor - INFO - Verified: 30 rows saved to models.xgboost_sales_cl_revenue_top
2025-07-14 01:17:20,289 - ModelTrainingRegressor - INFO - Sample of saved model results:
2025-07-14 01:17:20,311 - ModelTrainingRegressor - INFO - 
   iteration_id  k_folds  max_depth  ...  mae_score    cv_std                                       feature_data
0            10        4         13  ...   5.668303  1.699343  [{'iteration_id': 10, 'feature_name': 'num__Vo...
1            12        4          5  ...   5.669666  1.709727  [{'iteration_id': 12, 'feature_name': 'num__Vo...
2            14        4         10  ...   5.679188  1.714871  [{'iteration_id': 14, 'feature_name': 'num__Vo...

[3 rows x 15 columns]
2025-07-14 01:17:20,374 - ModelTrainingRegressor - INFO - Database connection closed
2025-07-14 01:17:20,374 - ModelTrainingRegressor - INFO - ✅ Model results saved to database successfully
2025-07-14 01:17:20,376 - ModelTrainingRegressor - INFO - Saving feature importance results to models.xgbreg_sales_cl_revenue_top
2025-07-14 01:17:20,376 - ModelTrainingRegressor - INFO - Database path: C:\Users\jason\assignment\assignment.duckdb
2025-07-14 01:17:20,434 - ModelTrainingRegressor - INFO - Created/verified schema: models
2025-07-14 01:17:20,434 - ModelTrainingRegressor - INFO - Dropped existing table if present: models.xgbreg_sales_cl_revenue_top
2025-07-14 01:17:20,439 - ModelTrainingRegressor - INFO - Successfully created table: models.xgbreg_sales_cl_revenue_top
2025-07-14 01:17:20,444 - ModelTrainingRegressor - INFO - Verified: 180 rows saved to models.xgbreg_sales_cl_revenue_top
2025-07-14 01:17:20,444 - ModelTrainingRegressor - INFO - Sample of saved feature importance results:
2025-07-14 01:17:20,455 - ModelTrainingRegressor - INFO - 
   iteration_id                 feature_name  feature_importance  explained_variance  feature_importance_rank
0            10           num__VolumeCred_CA            0.156720            0.156720                        6
1            10         num__TransactionsDeb            0.135357            0.135357                        4
2            10                  num__Tenure            0.151580            0.151580                        5
3            10  num__VolumeDeb_PaymentOrder            0.174962            0.174962                        1
4            10              num__VolumeCred            0.163603            0.163603                        3
2025-07-14 01:17:20,533 - ModelTrainingRegressor - INFO - Database connection closed
2025-07-14 01:17:20,533 - ModelTrainingRegressor - INFO - ✅ Feature importance results saved to database successfully
2025-07-14 01:17:21,518 - ModelTrainingRegressor - INFO - Dask client closed
