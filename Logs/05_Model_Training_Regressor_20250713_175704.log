2025-07-13 17:57:04,413 - ModelTrainingRegressor - INFO - Starting XGBoost regressor training process with Dask
2025-07-13 17:57:07,751 - ModelTrainingRegressor - INFO - Dask client created successfully
2025-07-13 17:57:07,752 - ModelTrainingRegressor - INFO - Dashboard link: http://127.0.0.1:8787/status
2025-07-13 17:57:07,753 - ModelTrainingRegressor - INFO - Workers: 5
2025-07-13 17:57:07,753 - ModelTrainingRegressor - INFO - Loading data from silver.train
2025-07-13 17:57:07,753 - ModelTrainingRegressor - INFO - Database path: C:\Users\jason\assignment\assignment.duckdb
2025-07-13 17:57:07,836 - ModelTrainingRegressor - INFO - Successfully loaded 242 rows and 36 columns
2025-07-13 17:57:07,836 - ModelTrainingRegressor - INFO - Data shape: (242, 36)
2025-07-13 17:57:07,871 - ModelTrainingRegressor - INFO - Starting regressor training with Dask...
2025-07-13 17:57:07,871 - ModelTrainingRegressor - INFO - Starting XGBoost regressor training with Dask
2025-07-13 17:57:07,871 - ModelTrainingRegressor - INFO - Response variable: Revenue_CC
2025-07-13 17:57:07,871 - ModelTrainingRegressor - INFO - Predictive variables: ['VolumeDebCashless_Card', 'Tenure', 'Age']
2025-07-13 17:57:07,871 - ModelTrainingRegressor - INFO - Categorical variables: []
2025-07-13 17:57:07,871 - ModelTrainingRegressor - INFO - Preparing data...
2025-07-13 17:57:07,876 - ModelTrainingRegressor - INFO - Data after cleaning: (242, 4)
2025-07-13 17:57:07,876 - ModelTrainingRegressor - INFO - Target variable statistics BEFORE scaling: mean=10.8625, std=34.1838, min=0.0714, max=407.9625
2025-07-13 17:57:07,876 - ModelTrainingRegressor - INFO - Applying StandardScaler to response variable...
2025-07-13 17:57:07,877 - ModelTrainingRegressor - INFO - Target variable statistics AFTER scaling: mean=-0.0000, std=1.0021, min=-0.3163, max=11.6407
2025-07-13 17:57:07,877 - ModelTrainingRegressor - INFO - Response variable scaling completed successfully
2025-07-13 17:57:07,878 - ModelTrainingRegressor - INFO - Setting up parallel training with Dask...
2025-07-13 17:57:07,885 - ModelTrainingRegressor - INFO - Created 30 parallel training tasks
2025-07-13 18:14:56,958 - ModelTrainingRegressor - INFO - Parallel training completed in 1069.07 seconds
2025-07-13 18:14:56,976 - ModelTrainingRegressor - INFO - Training completed. Generated 30 successful results
2025-07-13 18:14:56,978 - ModelTrainingRegressor - INFO - Best MAE score (on scaled target): 8.4831
2025-07-13 18:14:56,978 - ModelTrainingRegressor - INFO - Top 5 results (MAE on scaled target):
2025-07-13 18:14:56,978 - ModelTrainingRegressor - INFO -   Rank 1: MAE=8.4831, K-fold=4, max_depth=11, learning_rate=0.050
2025-07-13 18:14:56,978 - ModelTrainingRegressor - INFO -   Rank 2: MAE=8.4987, K-fold=4, max_depth=13, learning_rate=0.050
2025-07-13 18:14:56,978 - ModelTrainingRegressor - INFO -   Rank 3: MAE=8.5057, K-fold=4, max_depth=14, learning_rate=0.070
2025-07-13 18:14:56,978 - ModelTrainingRegressor - INFO -   Rank 4: MAE=8.5086, K-fold=4, max_depth=12, learning_rate=0.010
2025-07-13 18:14:56,978 - ModelTrainingRegressor - INFO -   Rank 5: MAE=8.5112, K-fold=5, max_depth=8, learning_rate=0.010
2025-07-13 18:14:56,988 - ModelTrainingRegressor - INFO - ✅ Regressor training completed successfully. Generated 30 result combinations
2025-07-13 18:14:56,990 - ModelTrainingRegressor - INFO - Saving model results to models.xgboost_sales_cc_revenue_top
2025-07-13 18:14:56,990 - ModelTrainingRegressor - INFO - Database path: C:\Users\jason\assignment\assignment.duckdb
2025-07-13 18:14:57,026 - ModelTrainingRegressor - INFO - Created/verified schema: models
2025-07-13 18:14:57,027 - ModelTrainingRegressor - INFO - Dropped existing table if present: models.xgboost_sales_cc_revenue_top
2025-07-13 18:14:57,050 - ModelTrainingRegressor - INFO - Successfully created table: models.xgboost_sales_cc_revenue_top
2025-07-13 18:14:57,051 - ModelTrainingRegressor - INFO - Verified: 30 rows saved to models.xgboost_sales_cc_revenue_top
2025-07-13 18:14:57,051 - ModelTrainingRegressor - INFO - Sample of saved model results:
2025-07-13 18:14:57,068 - ModelTrainingRegressor - INFO - 
   iteration_id  k_folds  max_depth  ...  mae_score    cv_std                                       feature_data
0            18        4         11  ...   8.483146  3.882598  [{'iteration_id': 18, 'feature_name': 'num__Vo...
1            11        4         13  ...   8.498678  3.890480  [{'iteration_id': 11, 'feature_name': 'num__Vo...
2            14        4         14  ...   8.505683  3.919270  [{'iteration_id': 14, 'feature_name': 'num__Vo...

[3 rows x 15 columns]
2025-07-13 18:14:57,149 - ModelTrainingRegressor - INFO - Database connection closed
2025-07-13 18:14:57,160 - ModelTrainingRegressor - INFO - ✅ Model results saved to database successfully
2025-07-13 18:14:57,163 - ModelTrainingRegressor - INFO - Saving feature importance results to models.xgbreg_sales_cc_revenue_top
2025-07-13 18:14:57,163 - ModelTrainingRegressor - INFO - Database path: C:\Users\jason\assignment\assignment.duckdb
2025-07-13 18:14:57,193 - ModelTrainingRegressor - INFO - Created/verified schema: models
2025-07-13 18:14:57,193 - ModelTrainingRegressor - INFO - Dropped existing table if present: models.xgbreg_sales_cc_revenue_top
2025-07-13 18:14:57,214 - ModelTrainingRegressor - INFO - Successfully created table: models.xgbreg_sales_cc_revenue_top
2025-07-13 18:14:57,216 - ModelTrainingRegressor - INFO - Verified: 90 rows saved to models.xgbreg_sales_cc_revenue_top
2025-07-13 18:14:57,216 - ModelTrainingRegressor - INFO - Sample of saved feature importance results:
2025-07-13 18:14:57,222 - ModelTrainingRegressor - INFO - 
   iteration_id                 feature_name  feature_importance  explained_variance  feature_importance_rank
0            18  num__VolumeDebCashless_Card            0.343209            0.343209                        1
1            18                  num__Tenure            0.323387            0.323387                        3
2            18                     num__Age            0.333403            0.333403                        2
3            11  num__VolumeDebCashless_Card            0.368600            0.368600                        1
4            11                  num__Tenure            0.320473            0.320473                        2
2025-07-13 18:14:57,273 - ModelTrainingRegressor - INFO - Database connection closed
2025-07-13 18:14:57,274 - ModelTrainingRegressor - INFO - ✅ Feature importance results saved to database successfully
2025-07-13 18:14:58,029 - ModelTrainingRegressor - INFO - Dask client closed
