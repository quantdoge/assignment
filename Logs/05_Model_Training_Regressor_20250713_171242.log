2025-07-13 17:12:42,059 - ModelTrainingRegressor - INFO - Starting XGBoost regressor training process with Dask
2025-07-13 17:12:45,572 - ModelTrainingRegressor - INFO - Dask client created successfully
2025-07-13 17:12:45,572 - ModelTrainingRegressor - INFO - Dashboard link: http://127.0.0.1:8787/status
2025-07-13 17:12:45,576 - ModelTrainingRegressor - INFO - Workers: 5
2025-07-13 17:12:45,577 - ModelTrainingRegressor - INFO - Loading data from silver.train
2025-07-13 17:12:45,578 - ModelTrainingRegressor - INFO - Database path: C:\Users\jason\assignment\assignment.duckdb
2025-07-13 17:12:45,668 - ModelTrainingRegressor - INFO - Successfully loaded 193 rows and 36 columns
2025-07-13 17:12:45,668 - ModelTrainingRegressor - INFO - Data shape: (193, 36)
2025-07-13 17:12:45,708 - ModelTrainingRegressor - INFO - Starting regressor training with Dask...
2025-07-13 17:12:45,708 - ModelTrainingRegressor - INFO - Starting XGBoost regressor training with Dask
2025-07-13 17:12:45,708 - ModelTrainingRegressor - INFO - Response variable: Revenue_MF
2025-07-13 17:12:45,708 - ModelTrainingRegressor - INFO - Predictive variables: ['VolumeDebCash_Card', 'VolumeDeb', 'VolumeDebCashless_Card', 'VolumeDeb_PaymentOrder']
2025-07-13 17:12:45,708 - ModelTrainingRegressor - INFO - Categorical variables: []
2025-07-13 17:12:45,708 - ModelTrainingRegressor - INFO - Preparing data...
2025-07-13 17:12:45,712 - ModelTrainingRegressor - INFO - Data after cleaning: (193, 5)
2025-07-13 17:12:45,713 - ModelTrainingRegressor - INFO - Target variable statistics BEFORE scaling: mean=9.6650, std=20.5742, min=0.0048, max=220.4882
2025-07-13 17:12:45,713 - ModelTrainingRegressor - INFO - Applying StandardScaler to response variable...
2025-07-13 17:12:45,713 - ModelTrainingRegressor - INFO - Target variable statistics AFTER scaling: mean=-0.0000, std=1.0026, min=-0.4707, max=10.2736
2025-07-13 17:12:45,713 - ModelTrainingRegressor - INFO - Response variable scaling completed successfully
2025-07-13 17:12:45,715 - ModelTrainingRegressor - INFO - Setting up parallel training with Dask...
2025-07-13 17:12:45,737 - ModelTrainingRegressor - INFO - Created 60 parallel training tasks
2025-07-13 17:18:03,352 - ModelTrainingRegressor - INFO - Parallel training completed in 317.61 seconds
2025-07-13 17:18:03,362 - ModelTrainingRegressor - INFO - Training completed. Generated 60 successful results
2025-07-13 17:18:03,362 - ModelTrainingRegressor - INFO - Best MAE score (on scaled target): 8.3911
2025-07-13 17:18:03,362 - ModelTrainingRegressor - INFO - Top 5 results (MAE on scaled target):
2025-07-13 17:18:03,362 - ModelTrainingRegressor - INFO -   Rank 1: MAE=8.3911, K-fold=5, max_depth=4, learning_rate=0.130
2025-07-13 17:18:03,362 - ModelTrainingRegressor - INFO -   Rank 2: MAE=8.3968, K-fold=5, max_depth=3, learning_rate=0.130
2025-07-13 17:18:03,362 - ModelTrainingRegressor - INFO -   Rank 3: MAE=8.3988, K-fold=5, max_depth=3, learning_rate=0.070
2025-07-13 17:18:03,362 - ModelTrainingRegressor - INFO -   Rank 4: MAE=8.3996, K-fold=5, max_depth=4, learning_rate=0.010
2025-07-13 17:18:03,362 - ModelTrainingRegressor - INFO -   Rank 5: MAE=8.3999, K-fold=5, max_depth=4, learning_rate=0.010
2025-07-13 17:18:03,378 - ModelTrainingRegressor - INFO - ✅ Regressor training completed successfully. Generated 60 result combinations
2025-07-13 17:18:03,378 - ModelTrainingRegressor - INFO - Saving model results to models.xgboost_sales_mf_revenue_top
2025-07-13 17:18:03,378 - ModelTrainingRegressor - INFO - Database path: C:\Users\jason\assignment\assignment.duckdb
2025-07-13 17:18:03,414 - ModelTrainingRegressor - INFO - Created/verified schema: models
2025-07-13 17:18:03,415 - ModelTrainingRegressor - INFO - Dropped existing table if present: models.xgboost_sales_mf_revenue_top
2025-07-13 17:18:03,453 - ModelTrainingRegressor - INFO - Successfully created table: models.xgboost_sales_mf_revenue_top
2025-07-13 17:18:03,454 - ModelTrainingRegressor - INFO - Verified: 60 rows saved to models.xgboost_sales_mf_revenue_top
2025-07-13 17:18:03,454 - ModelTrainingRegressor - INFO - Sample of saved model results:
2025-07-13 17:18:03,471 - ModelTrainingRegressor - INFO - 
   iteration_id  k_folds  max_depth  ...  mae_score    cv_std                                       feature_data
0            44        5          4  ...   8.391135  4.179483  [{'iteration_id': 44, 'feature_name': 'num__Vo...
1            41        5          3  ...   8.396843  4.187098  [{'iteration_id': 41, 'feature_name': 'num__Vo...
2            52        5          3  ...   8.398811  4.199074  [{'iteration_id': 52, 'feature_name': 'num__Vo...

[3 rows x 15 columns]
2025-07-13 17:18:03,527 - ModelTrainingRegressor - INFO - Database connection closed
2025-07-13 17:18:03,527 - ModelTrainingRegressor - INFO - ✅ Model results saved to database successfully
2025-07-13 17:18:03,533 - ModelTrainingRegressor - INFO - Saving feature importance results to models.xgbreg_sales_mf_revenue_top
2025-07-13 17:18:03,533 - ModelTrainingRegressor - INFO - Database path: C:\Users\jason\assignment\assignment.duckdb
2025-07-13 17:18:03,563 - ModelTrainingRegressor - INFO - Created/verified schema: models
2025-07-13 17:18:03,563 - ModelTrainingRegressor - INFO - Dropped existing table if present: models.xgbreg_sales_mf_revenue_top
2025-07-13 17:18:03,568 - ModelTrainingRegressor - INFO - Successfully created table: models.xgbreg_sales_mf_revenue_top
2025-07-13 17:18:03,568 - ModelTrainingRegressor - INFO - Verified: 240 rows saved to models.xgbreg_sales_mf_revenue_top
2025-07-13 17:18:03,568 - ModelTrainingRegressor - INFO - Sample of saved feature importance results:
2025-07-13 17:18:03,574 - ModelTrainingRegressor - INFO - 
   iteration_id                 feature_name  feature_importance  explained_variance  feature_importance_rank
0            44      num__VolumeDebCash_Card            0.275552            0.275552                        1
1            44               num__VolumeDeb            0.244660            0.244660                        3
2            44  num__VolumeDebCashless_Card            0.259635            0.259635                        2
3            44  num__VolumeDeb_PaymentOrder            0.220154            0.220154                        4
4            41      num__VolumeDebCash_Card            0.262212            0.262212                        1
2025-07-13 17:18:03,618 - ModelTrainingRegressor - INFO - Database connection closed
2025-07-13 17:18:03,619 - ModelTrainingRegressor - INFO - ✅ Feature importance results saved to database successfully
2025-07-13 17:18:04,377 - ModelTrainingRegressor - INFO - Dask client closed
